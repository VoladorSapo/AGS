// room script file

function room_Load()
{
SetBackgroundFrame(Noche);
if(!IntroRoom2Hecha){
cConde.ChangeRoom(2, 810,  1420, eDirectionLeft);
cJonathan.x=560;
cJonathan.y=1425;
cJonathan.FaceDirection(eDirectionDownRight);
}
}
function room_AfterFadeIn()
{
if(!IntroRoom2Hecha){
  dIntroRoom2.Start();
  IntroRoom2Hecha=true;
}
}

function on_key_press(eKeyCode keycode)
{

}



function room_RepExec()
{
//Si desde el codigo global se ordena cambiar de fondo
if(NocheEnRoom){
  if(Noche==0){
  SetFadeColor(80, 40, 1);
  FadeOut(10);
  
  Noche=1;
  
  //Cambio de View
  cJonathan.ChangeView(1);
  
  SetBackgroundFrame(Noche);
  
  Wait(10);
  SetFadeColor (75, 45, 0);
  FadeIn(10);
  NocheEnRoom=false;
  
  cJonathan.Think("Parece que me he pasado toda la tarde escribiendo.");
  cJonathan.Think("Lo mejor será que me vaya a la cama.");
  
  }else if(Noche==1){
  SetFadeColor (75, 45, 0);
  FadeOut(10);
  
  Noche=0;
  
  //Cambio de View
  cJonathan.ChangeView(1);
  
  SetBackgroundFrame(Noche);
  
  Wait(10);
  SetFadeColor(80, 40, 1);
  FadeIn(10);
  NocheEnRoom=false;
  }

}

}

function hSubirAlPiso2_WalkOn()
{
 player.x = 1792;
  player.y = 750;
  cJonathan.Walk(1776, 848, eBlock);
  cJonathan.FaceDirection(eDirectionLeft, eBlock);
  Game.Camera.AutoTracking=true;
}
function hBajarAlPiso1_WalkOn(){
 player.x = 1800;
  player.y = 1200;
  cJonathan.Walk(1760, 1370, eBlock);
  cJonathan.FaceDirection(eDirectionLeft, eBlock);
  Game.Camera.AutoTracking=true; 
}

function h_PuertaJ_Look()
{
  switch(Acto){
    case 2:
    cJonathan.Walk(100, 1500, eBlock);
cJonathan.Say("Estoy bastante cansado del viaje,\nmejor no intento ni salir");
break;
case 3:
player.Walk(100, 1500, eBlock);
dPuertaCerradaActo3.Start();
break;
default:
player.Walk(100, 1500, eBlock);
player.ChangeRoom(1, 3290, 495, eDirectionRight);

break;
  }
 

}


function room_FirstLoad()
{

}

function hMESA_Look()
{
cJonathan.Walk(340, 1450, eBlock);
cJonathan.Think("El señor Drácula se ha pasado,\nhay un montón de comida que se pondrá mala.");
cJonathan.Think("Pero como decían los siete sabios uno no acude al banquete\ndispuesto a ser llenado como un vaso vacío.");
}

function region1_WalksOnto()
{
  if(!YaDormidoRoom2){
cJonathan.Think("Creo que mañana debo afeitarme.");
  } else{
    cJonathan.Think("Aún no hace falta que me afeite, creo que puede aguantar otro día más.");
  }
}



function hEscritorioPegajoso_Look()
{
cJonathan.Walk(1260, 1415, eBlock);
if(!YaDormidoRoom2 && Noche==0){
  cJonathan.Think("Ya que estoy dejo mi diario, debería repasar lo que escribí.\nVamos, voy a cogerlo y así le hecho una ojeada.");
  //Play de un video escribiendo
  NocheGlobal=true;
  
}else if(!YaDormidoRoom2 && Noche==1){
  cJonathan.Think("No debería escribir de noche,\nes malo para la vista.");
  
}else if(YaDormidoRoom2){ 
  cJonathan.Think("¡Qué incómodo fue escribir sobre este escritorio!");
  cJonathan.Think("Está demasiado pegajoso.\n¿Me pregunto por qué será?");
}
}

function hCAMA_Look()
{
  cJonathan.Walk(1450, 1470, eBlock);
  if(!YaDormidoRoom2 && Noche==1){
  cJonathan.Think("La verdad es que estoy muy cansado.\nMe voy a acostar.");
  SetFadeColor(0, 0, 0);
  FadeOut(6);
  PlayVideo("zzz.ogv", eVideoSkipNotAllowed, 0);
  
  Noche=0;
  SetBackgroundFrame(Noche);
  SetFadeColor(80, 40, 1);
  FadeIn(6);
  
  
  YaDormidoRoom2=true;
  }else if(Noche==0){cJonathan.Think("Aún me quedan fuerzas para hacer algo más.");}
}

function hHotspot0_Look()
{
  
}
function hCuadro_Look()
{
cJonathan.Think("Sigo pensando que el retrato se parece demasiado al conde.");
cJonathan.Think("Además esos ojos negros parecen que te siguen con la mirada.");
}

function hChimenea_Look()
{
 if(NocheGlobal){
cJonathan.Think("Las llamas de la chimenea iluminan la habitación");
  } else{
    cJonathan.Think("Aún resplandecen resquicios de fuego entre la oscura ceniza.");
  }
}

function hLatigo_Look()
{
  cJonathan.Walk(932, 812, eBlock);
cJonathan.Think("Qué arma más chula!, es un látigo de cadenas que tiene por mango una especie de cruz.");
cJonathan.Think("También hay un pequeño letrero que pone “Familia Belmont”");
cJonathan.Think("¿A qué me recuerda ese apellido?");
}

function hMesa_Talk()
{
if(!MesaInteractuado){
  cJonathan.Think("¡Cuanta cantidad de libros en inglés!, hay revistas, periódicos, libros de toda índole, está incluso la guía telefónica de Londres.");
  cJonathan.Think("Y una buena pila de folios escritos por el conde.");
  MesaInteractuado = true;
}
if(HojasRestantes > 0){
  cJonathan.Think("Creo haber visto %d hojas más tiradas por la biblioteca.", HojasRestantes);
cJonathan.Think("Será mejor que las recoja, quizás el viento los haya esparcido.");
}else{
  if(HojasenMesa < 3){
    cJonathan.Think("Colocaré por aquí las hojas del conde.");
  }
}
}

function hEstanteria1_Look()
{
cJonathan.Walk(244,432,eBlock);
cJonathan.Think("Parecen ser libros muy antiguos y cubiertos de polvo. Hay bastantes títulos aristotélicos como la Metafísica, la Ética, la Comedia");
cJonathan.Think("...");
cJonathan.Think("¡¿Por cierto creía que ese libro de Aristóteles estaba perdido?!");
}
function hEstanteria2_Look()
{
cJonathan.Walk(520,43,eBlock);
cJonathan.Think("Parece ser una sección de libros de historia, geografía y política");
cJonathan.Think("A pesar de que el progreso tecnológico es cada vez mayor está claro que el ser humano no prospera en lo que respecta a lo humanístico.");
cJonathan.Say("¡Vaya! Aquú hay una hoja");
cJonathan.Think("Puntos de interés en Londres.");
cJonathan.Think("Mi investigación sobre las tierras Londinenzes prosigue. El primer punto que he de visitar es la Tower of London ya que todos los libros de referencia indican que efectivamente allí reside…");
cJonathan.Think("Además no queda lejos de donde acaba de nacer esa chica, esa que veo en sueños, sin lugar a dudas es ella, Elizabeth has renacido tras tantos siglos…");
player.AddInventory(iHoja2);
}
function hEstanteria3_Look()
{
cJonathan.Walk(1368,432, eBlock);
cJonathan.Think("Una colección de libros clásicos, no pueden faltar obras como La Odisea o Las mil y una noche.");
cJonathan.Think("¡Anda pero si están los infiernos de Dante!, quizás debería leerme esa obra.");
}
function hEstanteria4_Look()
{
cJonathan.Walk(1666,432,eBlock);
cJonathan.Think("¡Que chulada la cubierta de este libro!");
cJonathan.Think("...");
cJonathan.Think("Está en latín, voy a ver su interior");
cJonathan.Think("...");
cJonathan.Think("“WHAT A HORRIBLE NIGHT TO HAVE A CURSE”(Que horrible noche para sufrir una maldición)");
cJonathan.Think("...");
cJonathan.Think("No suena muy bien, va a ser mejor que lo cierre.");
cJonathan.Think("Al cerrarlo se ha caido una hoja");
oHoja3.Visible = true;
}

function hMesa_UseInv()
{
if(player.ActiveInventory == iHoja1 ||player.ActiveInventory == iHoja2 ||player.ActiveInventory == iHoja3){
  cJonathan.Think("Dejaré esta hoja en la mesa");
  cJonathan.LoseInventory(player.ActiveInventory);
  HojasenMesa++;
  }
  if(HojasenMesa >= 3){
    dBibliotecaActo3.Start();
  }
}

function oHoja1_Interact()
{
cJonathan.Walk(138,  450,  eBlock);
cJonathan.Think("Aquí hay una hoja");
cJonathan.Think("Propiedades de interés.");
cJonathan.Think("Londres es una tierra civilizada, cuna del modernismo. Algunos la denominan la metrópolis de la modernidad. ");
cJonathan.Think("Es por ello que estimado conde Drácula es difícil encontrar propiedades antiguas que se encuentren en circulación. ");
cJonathan.Think("Sin embargo, mi búsqueda es incesante y pongo todos mis contactos y medios para buscar la propiedad ideal para usted. ");
cJonathan.Think("A continuación le notificó las últimas propiedades que han entrado en mi radar:");
cJonathan.Think("Dover Castle, ubicado a medio día a caballo desde la capital. Es una construcción del S.XIII, conocida popularmente como la llave de Inglaterra. Su precio se ajusta a lo acordado.");
cJonathan.Think("Carfax estate, es una propiedad situada en las afueras de Londres, pese a ser una propiedad más reducida que la anterior la extensión de finca de recreo es de un tamaño muy considerable.");
cJonathan.Think("Pero quizás sobrepasa algo la cantidad de shelins que estipulamos.");
cJonathan.Think("En cualquier caso mi dependiente Jonathan Harker acudirá este mayo a su tierra. No obstante continuamos con las negociaciones…");

  cJonathan.AddInventory(iHoja1);
  oHoja1.Visible=false;
  HojasRestantes --;
}

function oHoja3_Interact()
{
cJonathan.Think("Anoche mis ojos te miraron por última vez, mis sueños cada vez son más esclarecedores.");
cJonathan.Think("Mi amada, queda poco para que llegue a Londres, entonces podremos entrelazar nuestras almas y los labios sellarán nuestro último aliento en la eternidad de los tiempos…");
cJonathan.AddInventory(iHoja3);
  oHoja3.Visible=false;
  HojasRestantes --;
}
